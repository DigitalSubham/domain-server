<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Domain Age Checker</title>
</head>

<body>

    <div class="container mt-3" style="width: 450px;">
        <h2>Domain Age Checker</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Domain Name</th>
                    <th>Domain Created on</th>
                    <th>Age</th>
                    <th>Domain Updated on</th>
                    <th>Domain Expiration Date</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td id="name"></td>
                    <td id="domainCreated"></td>
                    <td id="age"></td>
                    <td id="domainUpdated"></td>
                    <td id="domainExpiration"></td>
                </tr>
            </tbody>
        </table>
        <div>
            <label for="domainInput">Enter Domain Name:</label>
            <input type="text" id="domainInput">
            <button onclick="domainAge()">Lookup</button>
        </div>
    </div>
    <script>
        async function domainAge() {
            const domain = document.getElementById("domainInput").value;
            const response = await fetch(`http://localhost:3000/whois?domain=${domain}`);
            const data = await response.json();
            // console.log(data);

            // Convert creation_date, updated_date, and expiration_date to Date objects
            const creationDate = new Date(data.creation_date);
            const updatedDate = new Date(data.updated_date);
            const expirationDate = new Date(data.expiration_date);

            // Calculate age
            const age = calculateAge(creationDate);

            // Update DOM elements
            document.getElementById("name").innerHTML = domain;
            document.getElementById("domainCreated").innerHTML = creationDate.toLocaleDateString();
            document.getElementById("age").innerHTML = age;
            document.getElementById("domainUpdated").innerHTML = updatedDate.toLocaleDateString();
            document.getElementById("domainExpiration").innerHTML = expirationDate.toLocaleDateString();
        }

        function calculateAge(creationDate) {
            const start = new Date(creationDate);
            const end = new Date();
            let difference = end - start;
            const daysDifference = Math.floor(difference / (1000 * 60 * 60 * 24));

            // Calculate years and remaining days
            const years = Math.floor(daysDifference / 365);
            const remainingDays = daysDifference % 365;

            return `${years} years ${remainingDays} days`;
        }
    </script>
</body>

</html>